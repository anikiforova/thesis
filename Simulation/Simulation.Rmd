---
title: "Algorithm comparison"
author: "Ana Dimitrova"
output: pdf_document

---
 

```{r setup, include=TRUE, echo=FALSE}
library(ggplot2)
library(scales)
library(gridExtra)

path = "~/Documents/ETH/Thesis/1plusX/Data/Thesis/Simulation/Results/"
plot_results <- function(algorith_name="Random") {
  
  data <- read.csv(file=paste0(path, paste0(algorith_name, ".csv")), header=TRUE, sep=",")
  data$Percent = data$Clicks / data$Impressions * 100
  data$Factor = paste(data$Method, data$Alpha, sep=" ")

  ggplot(data, aes(x=Impressions, y=Percent, colour=Factor)) + 
  geom_line() + xlab("Impressions") + ylab("% of Clicks") +
  expand_limits(y=c(4,7.5), x=c(0, 75000)) + theme_bw() + ggtitle(algorith_name)
}
  
```


```{r linucb-hybrid, include=TRUE, echo=FALSE}
algorith_name="Simulation_Results"
data <- read.csv(file=paste0(path, paste0(algorith_name, ".csv")), header=TRUE, sep=",")
data$Percent = data$X7 / data$X100 * 100
data$Factor = paste(data$SRandom, data$X0.00, sep=" ")

ggplot(data, aes(x=X100, y=Percent, colour=Factor)) + 
geom_line() + xlab("Impressions") + ylab("% of Clicks") +
expand_limits(y=c(0,100), x=c(0, 20000)) + theme_bw() + ggtitle(algorith_name)
  
```

```{r gpprank, include=TRUE, echo=FALSE}
algorith_name="Simulation_Results_Poly"
data <- read.csv(file=paste0(path, paste0(algorith_name, ".csv")), header=TRUE, sep=",")
data$Percent = data$X4 / data$X100 * 100
data$Factor = paste(data$SRandom, data$X0.00, sep=" ")

ggplot(data, aes(x=X100, y=Percent, colour=Factor)) + 
geom_line() + xlab("Impressions") + ylab("% of Clicks") +
expand_limits(y=c(0,100), x=c(0, 10000)) + theme_bw() + ggtitle(algorith_name)
```
```{r Poly_Sigmoid, include=TRUE, echo=FALSE}
algorith_name="Poly_Sigmoid"
data <- read.csv(file=paste0(path, paste0(algorith_name, ".csv")), header=TRUE, sep=",")

data = aggregate(x=data[c("ClickCount")], by=data[c("Impressions", "AlgoName", "Alpha", "OverallCTR", "Randomized")], mean)

data$Percent = data$ClickCount / data$Impressions * 100
data$Factor = paste(data$AlgoName, " CTR ", data$OverallCTR, sep=" ")

#data = data[data$Randomized=="False",]
data = data[data$OverallCTR ==0.05,]
ggplot(data, aes(x=Impressions, y=Percent, colour=Factor)) + 
geom_line() + xlab("Impressions") + ylab("% of Clicks") +
expand_limits(y=c(0,100), x=c(0, 1000)) + theme_bw() + ggtitle(algorith_name)
```
```{r Poly_Sigmoid, include=TRUE, echo=FALSE}
algorith_name="Poly_Sigmoid"
data <- read.csv(file=paste0(path, paste0(algorith_name, ".csv")), header=TRUE, sep=",")

data = aggregate(x=data[c("ClickCount")], by=data[c("Impressions", "AlgoName", "Alpha", "OverallCTR", "Randomized")], mean)

data$Percent = data$ClickCount / data$Impressions * 100
data$Factor = paste(data$AlgoName, " CTR ", data$OverallCTR, sep=" ")

#data = data[data$Randomized=="False",]
#data = data[data$OverallCTR ==0.005,]
ggplot(data, aes(x=Impressions, y=Percent, colour=Factor)) + 
geom_line() + xlab("Impressions") + ylab("% of Clicks") +
expand_limits(y=c(0,100), x=c(0, 1000)) + theme_bw() + ggtitle(algorith_name)
```
