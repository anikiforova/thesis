---
title: "Algorithm comparison"
author: "Ana Dimitrova"
output: pdf_document

---
 

```{r setup, include=TRUE, echo=FALSE}
library(ggplot2)
library(scales)
library(gridExtra)

path = "~/Documents/ETH/Thesis/1plusX/Data/Thesis/1plusx/Results/"
plot_results <- function(algorith_name="Random") {
  
  data <- read.csv(file=paste0(path, paste0(algorith_name, ".csv")), header=TRUE, sep=",")
  data$Percent = data$Clicks / data$Impressions * 100
  data$Factor = paste(data$Method, sep=" ")

  ggplot(data, aes(x=TotalImpressions, y=Percent, colour=Factor)) + 
    stat_smooth(aes(x = TotalImpressions, y = Percent), method = "lm",
                formula = y ~ poly(x, 10), se = FALSE) +
    xlab("Impressions") + ylab("% of Clicks") +
    #expand_limits(y=c(4,7.5), x=c(0, 225000)) + 
    theme_bw() + ggtitle(algorith_name)
}
  
```

```{r all_algos, include=TRUE, echo=FALSE}

files = c("Regression")

data <- read.csv(file=paste0(path, paste0("Random", ".csv")), header=TRUE, sep=",")
for (name in files){
  data1 <- read.csv(file=paste0(path, paste0(name, ".csv")), header=TRUE, sep=",")
  data <- rbind(data, data1)  
}

data$Percent = data$Clicks / data$Impressions * 100
data$Factor = paste(data$Method, sep=" ")

selected = data[(data$Method == "Random") 
      | (data$Method == "Regression") 
      ,]

ggplot(selected, aes(x=TotalImpressions, y=Percent, colour=Factor)) + 
    stat_smooth(aes(x=TotalImpressions, y=Percent), method = "lm",
                formula = y ~ poly(x, 10), se = FALSE) +
    xlab("Impressions") + ylab("% of Clicks") +
    #expand_limits(y=c(4,7.5), x=c(0, 225000)) + 
    theme_bw() + ggtitle("All")
```